<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Device Assign</title>
    <!-- Bootstrap CSS -->
    <link href="https://maxcdn.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css" rel="stylesheet">
    <!-- Custom CSS -->
    <style>
        /* Custom CSS styles */
        .container {
            margin-top: 50px;
        }
        .device-table th, .device-table td {
            vertical-align: middle;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>Assign Device</h1>
<!--        <p>Assign the device to a user:</p>-->
        <form action="{{ url_for('assigning_devices') }}" method="POST">
        <table class="table device-table">
            <thead>
                <tr>
                    <th>Customer Name</th>
                    <th>Device Name</th>
                    <th>Serial Number</th>
                    <th>Issue Description</th>
                    <th>Delivery Date</th>
                    <th>Select User</th>
                    <th>Action</th>
                </tr>
            </thead>
<!--            <tbody>-->
<!--                {% for device in unassigned_devices %}-->
<!--                {% for customer in customer %}-->
<!--                <tr>-->
<!--                    <td>{{ customer.name }}</td>-->
<!--                    <td>{{ device.device_name }}</td>-->
<!--                    <td>{{ device.serial_number }}</td>-->
<!--                    <td>{{ device.issue_description }}</td>-->
<!--                    <td>{{ device.expected_delivery_date }}</td>-->
<!--                    <td>-->

<!--                        <select name="user_id" class="form-control">-->
<!--                            {% for user in available_users %}-->
<!--                                <option value="{{ user.id }}">{{ user.username }}</option>-->
<!--                            {% endfor %}-->
<!--                        </select>-->
<!--                    </td>-->
<!--                    <td>-->
<!--                        <button type="submit" class="btn btn-primary">Assign</button>-->
<!--                    </td>-->
<!--                </tr>-->
<!--            {% endfor %}-->
<!--            {% endfor %}-->
<!--            </tbody>-->
            <tbody>
    {% for device in unassigned_devices %}
        <tr>
            {% set found_customer = false %}
            {% for customer in customer %}
                {% if device.customer_id == customer.id %}
                    <td>{{ customer.name }}</td>
                    {% set found_customer = true %}
                {% endif %}
            {% endfor %}
            {% if not found_customer %}
                <td>No Customer Assigned</td>
            {% endif %}
            <td>{{ device.device_name }}</td>
            <td>{{ device.serial_number }}</td>
            <td>{{ device.issue_description }}</td>
            <td>{{ device.expected_delivery_date }}</td>
            <td>
                <form action="{{ url_for('assigning_devices') }}" method="POST">
                    <select name="user_id" class="form-control">
                        {% for user in available_users %}
                            <option value="{{ user.id }}">{{ user.username }}</option>
                        {% endfor %}
                    </select>
                    <input type="hidden" name="device_id" value="{{ device.id }}">
                    <button type="submit" class="btn btn-primary">Assign</button>
                </form>
            </td>
        </tr>
    {% endfor %}
</tbody>

        </table>
        </form>

    </div>

    <!-- Bootstrap JS (Optional) -->
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.16.0/umd/popper.min.js"></script>
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.5.2/js/bootstrap.min.js"></script>
</body>
</html>
